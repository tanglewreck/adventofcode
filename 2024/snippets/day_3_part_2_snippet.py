# coding: utf-8
get_ipython().run_line_magic('history', '-g')
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
for c in testdata2:
    if c in "mul":
        print(c)
for c in testdata2:
    if c in "mul":
        print(c, end="")
for c in testdata2:
    if c in "mul":
        print(c, end="")
    print()
for c in testdata2:
    if c in "mul":
        print(c, end="")
        print()
for c in testdata2:
    if c in "mul":
        print(c, sep=" ", end="")
        print()
for c in testdata2:
    if c in "mul":
        print(c, sep=" ", end="")
    print()
for c in testdata2:
    if c in "mul":
        print(c, sep=" ", end="")
print()
for c in testdata2:
    if c in "mul()":
        print(c, sep=" ", end="")
print()
curr_c = testdata2[0]
    for c in testdata2:

    if c in "mul()":
        print(c, sep=" ", end="")
print()
from string import digits
digits
mul_characters = "mul,()" + digits
mul_characters
from string import digits
from string import digits
mul_characters = "mul,()" + digits
    curr_c = testdata2[0]
    for c in testdata2:

    if c in mul_characters:
        print(c, sep=" ", end="")
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
    for c in testdata2:

    if c in mul_characters:
        print(c, sep=" ", end="")
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
    # for c in testdata2:
    if c in mul_characters:
        print(c, sep=" ", end="")
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
for c in testdata2:
    if c in mul_characters:
        print(c, sep=" ", end="")
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
curr_mul = []
for k, c in enumerate(testdata2):
    try:
        if c == 'm' and testdata2[k+1] == 'u':
        print("mu")
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
curr_mul = []
for k, c in enumerate(testdata2):
    try:
        if c == 'm' and testdata2[k+1] == 'u':
        print("mu")
    except IndexError:
        pass
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
curr_mul = []
for k, c in enumerate(testdata2):
    try:
        if c == 'm' and testdata2[k+1] == 'u':
            print("mu")
    except IndexError:
        pass
print()
from string import digits
mul_characters = "mul,()" + digits
curr_c = testdata2[0]
curr_mul = []
for k, c in enumerate(testdata2):
    try:
        if c == 'm' and testdata2[k+1] == 'u' and testdata[k+2] == 'l':
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    try:
        if c == 'm' and td2[k+1] == 'u' and td2[k+2] == 'l':
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    try:
        if c == 'm' and td2[k+1] == 'u' and td2[k+2] == 'l':
            print("mul")
    except IndexError:
        pass
print()
td2[2:4]
if td2[2:4] == 'ul:
if td2[2:4] == 'ul':
    print("ul")
if td2[2:4] == 'ul':
    print("ullll")
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    try:
        if c[k:k+2] == "mul":
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    try:
        if c[k:k+3] == "mul":
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    print(k, c)
    try:
        if c[k:k+3] == "mul":
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
    print(f"{k}: {td2[k:k+3]} ")
    try:
        if c[k:k+3] == "mul":
            print("mul")
    except IndexError:
        pass
print()
td2[48:48+3]
td2[48:48+3] == "mul"
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        if td2[k:k+3] == "mul":
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        if td2[k:k+4] == "mul(":
            print("mul")
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = td2[k:k+4]
        if curr_str == "mul(":
            print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = td2[0]
curr_mul = []
for k, c in enumerate(td2):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = td2[k:k+4]
        if curr_str == "mul(" and td2[k+5] in digits:
            print(curr_str + td[k+5])
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul(" and d[k+5] in digits:
            print(curr_str + d[k+5])
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = []
            while valid:
                next_c = d[k+i]
                print(next_c)
                valid = next_c in (digits + ",")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = []
            while valid:
                next_c = d[k+i]
                print(next_c)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = []
            while valid:
                next_c = d[k+i]
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split() + d[k+4]
            while valid:
                next_c = d[k+i]
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split() + [d[k+4]]
            while valid:
                next_c = d[k+i]
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                next_c = d[k+i]
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                if next_c := d[k+i] == ")":
                    rest.append(next_c)
                    break
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                next_c = d[k+i]
                if next_c == ")":
                    rest.append(next_c)
                    break
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            # print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                next_c = d[k+i]
                if next_c == ")":
                    rest.append(next_c)
                    break
                rest.append(next_c)
                print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
            print(rest)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            # print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                next_c = d[k+i]
                if next_c == ")":
                    rest.append(next_c)
                    break
                rest.append(next_c)
                # print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
            print(rest)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        valid = True
        if curr_str == "mul(" and d[k+4] in digits:
            # print(curr_str + d[k+4])
            i = 4
            rest = curr_str.split()
            while valid:
                next_c = d[k+i]
                if next_c == ")":
                    rest.append(next_c)
                    break
                rest.append(next_c)
                # print(rest)
                valid = next_c in (digits + "," + ")")
                i += 1
            print("".join(rest))
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul":
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "("):
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul":
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul":
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                breakpoint()
                if c != "(":
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul":
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        if curr_str == "mul":
            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
d
enumerate(d)
list(enumerate(d))
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        print(curr_str)        
        if curr_str == "mul":
            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
        print(curr_str)        
        if curr_str == "mul(":
            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+4]
#        print(curr_str)        
        if curr_str == "mul(":
            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[i]
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, c in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
#        print(curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 4
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
d[64]
d[64:66]
d[64:67]
d[68]
d[67]
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
d[64:64+3]
d[67]
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = dk+[i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; print(c)
                i += 1
                if c != "(":
                    print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do_encounterd = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do = d[k:k+5]
        if do == "do()":
            do_encounterd = True
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        print(curr_str)
    except IndexError:
        pass
print()
d[10:20]
d[10:30]
d[60:90]
d[58:65]
d[59:65]
d[59:63]
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't():
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
    except IndexError:
        pass
print()
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul += curr_str
    except IndexError:
        pass
print(curr_mul)
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul += "".join(curr_str)
    except IndexError:
        pass
print(curr_mul)
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
print(curr_mul)
def mul(x: int|float, y: int|float) -> int|float:
    return x * y
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
print(curr_mul)
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
    print(curr_mul)
for m in curr_mul:
    print(eval(m))
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
print(curr_mul)
for m in curr_mul:
    print(eval(m))
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
print(curr_mul)
for m in curr_mul:
    print(eval(m))
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
print(curr_mul)
sum = 0
for m in curr_mul:
    sum += eval(m)
print(sum)
testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            # print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
# print(curr_mul)
sum = 0
for m in curr_mul:
    sum += eval(m)
print(sum)
get_ipython().run_line_magic('save', 'snippets/day_3_part_2_snippet.py')
#testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
with open("data/day_3_data") as fp:
    testdata2 = fp.read()
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
# curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            # print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
# print(curr_mul)
sum = 0
for m in curr_mul:
    sum += eval(m)
print(sum)
testdata2
#testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
with open("data/day_3_data") as fp:
    testdata2 = fp.read().strip()
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
# curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            # print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
# print(curr_mul)
sum = 0
for m in curr_mul:
    sum += eval(m)
print(sum)
#testdata2 = "xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))"
with open("data/day_3_data") as fp:
    testdata2 = fp.read().strip()
td2 = testdata2
d = testdata2
from string import digits
mul_characters = "mul,()" + digits
# curr_c = d[0]
curr_mul = []
do = True
for k, x in enumerate(d):
#    print(f"{k}: {td2[k:k+3]} ")
    try:
        curr_str = d[k:k+3]
        do_str = d[k:k+4]
        if do_str == "do()":
            do = True
        dont_str = d[k:k+7]
        if dont_str == "don't()":
            do = False
        # print(k, curr_str)        
        if curr_str == "mul":
#            print(curr_str)
            valid = True
            i = 3
            while valid:
                # get next character
                c = d[k+i]; # print(c)
                i += 1
                if c != "(":
                    #print(f"{k}: c != '('")
                    valid = False
                    break
                curr_str += "("
                c = d[k+i]
                i += 1
                while c in digits + ",":
                    curr_str += c
                    c = d[k+i]; i += 1
                else:
                    if not c == ")":
                        valid = False
                        continue
                    else:
                        curr_str += c
                        if do:
                            # print(curr_str)
                            curr_mul.append(curr_str)
    except IndexError:
        pass
# print(curr_mul)
sum = 0
for m in curr_mul:
    #sum += eval(m)
    print(m)
print(sum)
